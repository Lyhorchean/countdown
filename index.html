<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Khmer-style Countdown (Angkor Wat)</title>

<!-- Noto Sans Khmer for Khmer-styled lettering (English text) -->
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Khmer:wght@300;400;700&display=swap" rel="stylesheet">

<style>
  :root{
    --bg-img: url('https://images.unsplash.com/photo-1517821099607-4b5b9c0b9c3d?auto=format&fit=crop&w=1600&q=80'); /* Replace with your chosen Angkor Wat image URL */
    --gold1: #cda14a;
    --gold2: #f4d27a;
    --overlay: rgba(15,10,8,0.45);
    --accent: rgba(255, 230, 170, 0.95);
  }

  html,body{
    height:100%;
    margin:0;
    font-family: "Noto Sans Khmer", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    color:#fff;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    background: #000;
  }

  .bg{
    position:fixed;
    inset:0;
    background-image: linear-gradient(180deg, rgba(0,0,0,0.15), rgba(0,0,0,0.45)), var(--bg-img);
    background-size:cover;
    background-position:center center;
    filter:contrast(1.03) saturate(1.05);
    z-index:0;
  }

  .overlay{
    position:fixed;
    inset:0;
    background: linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.55));
    z-index:1;
  }

  .container{
    position:relative;
    z-index:2;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:2rem;
    box-sizing:border-box;
  }

  .card{
    max-width:920px;
    width:100%;
    background: linear-gradient(135deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
    border-radius:18px;
    padding:40px;
    box-shadow: 0 12px 40px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.04);
    backdrop-filter: blur(6px) saturate(1.1);
    text-align:center;
    color:var(--accent);
  }

  header h1{
    margin:0 0 6px 0;
    font-size:2.15rem;
    letter-spacing:1px;
    color:var(--gold2);
    text-shadow: 0 2px 12px rgba(0,0,0,0.5);
  }
  header p{
    margin:0 0 20px 0;
    opacity:0.95;
    font-size:1rem;
  }

  .countdown{
    display:flex;
    gap:14px;
    justify-content:center;
    margin:18px 0 8px;
    flex-wrap:wrap;
  }

  .time-block{
    min-width:110px;
    padding:18px 14px;
    background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.12));
    border-radius:12px;
    border: 1px solid rgba(255,200,90,0.06);
    box-shadow: 0 8px 22px rgba(0,0,0,0.45);
  }

  .time-block .num{
    font-size:2.05rem;
    font-weight:700;
    color:var(--gold2);
    margin-bottom:6px;
  }
  .time-block .label{
    font-size:.85rem;
    color:rgba(255,255,255,0.8);
  }

  .message{
    margin-top:14px;
    font-size:1rem;
    opacity:0.95;
  }

  .live-badge{
    display:inline-flex;
    align-items:center;
    gap:8px;
    background: linear-gradient(90deg, rgba(255,140,10,0.1), rgba(200,120,40,0.06));
    color: #fff;
    border: 1px solid rgba(255,200,90,0.18);
    padding:8px 12px;
    border-radius:999px;
    font-weight:700;
    box-shadow: 0 6px 18px rgba(0,0,0,0.35);
    transform-origin:center;
    transition: transform .25s ease, opacity .25s ease;
  }

  .closed-overlay{
    position:fixed;
    inset:0;
    z-index:9999;
    display:flex;
    align-items:center;
    justify-content:center;
    flex-direction:column;
    background:linear-gradient(180deg, rgba(5,5,8,0.92), rgba(5,5,8,0.98));
    color:var(--gold2);
    padding:20px;
    text-align:center;
  }

  .closed-overlay h2{ margin:0 0 10px; font-size:2.25rem; }
  .closed-overlay p{ margin:0 0 20px; opacity:0.9; }

  /* Responsive */
  @media (max-width:640px){
    .card{ padding:20px; border-radius:12px; }
    .time-block{ min-width:82px; padding:12px 8px; }
    .time-block .num{ font-size:1.45rem; }
    header h1{ font-size:1.6rem; }
  }

  /* small flourish: subtle Khmer motif line */
  .motif{
    height:6px;
    width:180px;
    margin:18px auto;
    background: linear-gradient(90deg, rgba(255,230,160,0.25), rgba(255,200,90,0.18));
    border-radius:3px;
    box-shadow: 0 6px 14px rgba(200,140,60,0.06) inset;
  }

  .footer-note { margin-top:18px; font-size:.85rem; opacity:0.85; }
</style>
</head>
<body>
  <div class="bg" aria-hidden="true"></div>
  <div class="overlay" aria-hidden="true"></div>

  <div class="container">
    <div class="card" role="main" aria-live="polite">
      <header>
        <h1>Angkor Wat Countdown</h1>
        <p class="subtitle">An elegant Khmer-inspired countdown — English text, Khmer style.</p>
      </header>

      <div class="motif" aria-hidden="true"></div>

      <div id="liveBadge" class="live-badge" style="display:none;">
        <svg width="14" height="14" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="10" fill="rgba(240,120,30,0.95)"/></svg>
        <span id="liveText">LIVE — 1 hour to go</span>
      </div>

      <div class="countdown" id="countdown">
        <div class="time-block">
          <div class="num" id="days">--</div>
          <div class="label">DAYS</div>
        </div>
        <div class="time-block">
          <div class="num" id="hours">--</div>
          <div class="label">HOURS</div>
        </div>
        <div class="time-block">
          <div class="num" id="minutes">--</div>
          <div class="label">MINUTES</div>
        </div>
        <div class="time-block">
          <div class="num" id="seconds">--</div>
          <div class="label">SECONDS</div>
        </div>
      </div>

      <div class="message" id="message">
        Event time: <strong id="eventTimeRead">—</strong>
      </div>

      <div class="footer-note">
        Tip: replace the background with any high-res Angkor Wat image from Unsplash or Pexels for best visual result. 
      </div>
    </div>
  </div>

  <!-- Closed overlay (hidden until triggered) -->
  <div id="closedOverlay" class="closed-overlay" style="display:none;">
    <h2>Closed</h2>
    <p>This event is now closed. Thank you.</p>
    <button id="reopenBtn" style="padding:10px 18px;border-radius:8px;border:none;background:var(--gold1);color:#111;font-weight:700;cursor:pointer;">Return</button>
  </div>

<script>
  // ======= CONFIG =======
  // Set your event time (ISO 8601). Example: "2025-12-31T18:00:00+07:00"
  const eventTimeISO = "2025-12-31T18:00:00+07:00";

  // Option: set to true to try to redirect to about:blank after close (some browsers will block)
  const redirectAfterClose = false;
  const redirectURL = "about:blank";

  // ======= END CONFIG =======

  const eventTime = new Date(eventTimeISO);
  const eventTimeReadEl = document.getElementById('eventTimeRead');
  eventTimeReadEl.textContent = eventTime.toLocaleString();

  const daysEl = document.getElementById('days');
  const hoursEl = document.getElementById('hours');
  const minutesEl = document.getElementById('minutes');
  const secondsEl = document.getElementById('seconds');
  const liveBadge = document.getElementById('liveBadge');
  const liveText = document.getElementById('liveText');
  const messageEl = document.getElementById('message');
  const closedOverlay = document.getElementById('closedOverlay');
  const reopenBtn = document.getElementById('reopenBtn');

  reopenBtn.addEventListener('click', () => {
    closedOverlay.style.display = 'none';
    // reload page if user wants
    location.reload();
  });

  function formatNumber(n){
    return String(n).padStart(2,'0');
  }

  function update(){
    const now = new Date();
    let diff = (eventTime.getTime() - now.getTime()) / 1000; // seconds

    if (diff <= 0){
      // Time is up
      daysEl.textContent = "00";
      hoursEl.textContent = "00";
      minutesEl.textContent = "00";
      secondsEl.textContent = "00";
      liveBadge.style.display = 'none';
      messageEl.innerHTML = "<strong>The event time has arrived.</strong>";

      // Try to close the window (works if opened by script). Then fallback to Closed overlay.
      tryClose();
      return;
    }

    // Show Live badge 1 hour before
    if (diff <= 3600){
      liveBadge.style.display = 'inline-flex';
      const minsLeft = Math.ceil(diff / 60);
      liveText.textContent = `LIVE — ${minsLeft} minute${minsLeft===1?'':'s'} to go`;
    } else {
      liveBadge.style.display = 'none';
    }

    // Compute time parts
    const days = Math.floor(diff / 86400);
    diff -= days * 86400;
    const hours = Math.floor(diff / 3600);
    diff -= hours * 3600;
    const mins = Math.floor(diff / 60);
    const secs = Math.floor(diff % 60);

    daysEl.textContent = formatNumber(days);
    hoursEl.textContent = formatNumber(hours);
    minutesEl.textContent = formatNumber(mins);
    secondsEl.textContent = formatNumber(secs);

    // Friendly message
    const parts = [];
    if (days > 0) parts.push(`${days} day${days>1?'s':''}`);
    if (hours > 0) parts.push(`${hours} hour${hours>1?'s':''}`);
    if (days === 0 && hours === 0) parts.push(`${mins} minute${mins>1?'s':''}`);
    messageEl.innerHTML = `Time remaining: <strong>${parts.slice(0,2).join(', ')}</strong>`;
  }

  function tryClose(){
    // Attempt to close the window. Many browsers block this unless opened via script.
    // We try, and after a short timeout show the "Closed" overlay as fallback.
    try {
      window.close();
    } catch (e){
      // ignore
    }
    // After a short delay check if page is still visible; if yes, show closed overlay.
    setTimeout(() => {
      // If still not closed, show fallback overlay and optionally redirect.
      if (!document.hidden){
        closedOverlay.style.display = 'flex';
        // Optionally navigate away (comment/uncomment as desired)
        if (redirectAfterClose){
          window.location.href = redirectURL;
        }
      }
    }, 700);
  }

  // Start ticking
  update();
  const t = setInterval(() => {
    update();
    // If event passed, clear interval
    if (new Date() >= eventTime){
      clearInterval(t);
    }
  }, 1000);

  // Accessibility: announce 1-hour message when crossing threshold
  let announcedOneHour = false;
  const announcer = document.createElement('div');
  announcer.setAttribute('aria-live','polite');
  announcer.style.position='absolute';
  announcer.style.left='-9999px';
  document.body.appendChild(announcer);

  setInterval(() => {
    const now = new Date();
    const diff = (eventTime.getTime() - now.getTime())/1000;
    if (!announcedOneHour && diff <= 3600 && diff > 3590){
      announcer.textContent = "One hour remaining.";
      announcedOneHour = true;
    }
  }, 1000);
</script>
</body>
</html>
